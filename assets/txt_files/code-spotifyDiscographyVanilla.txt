window.onload = function(){<br>  var artistSearchForm = document.getElementById(\'artistSearchForm\');<br>  var artistNameEntry = document.getElementById(\'artistNameEntry\');<br>  var submitButton = document.getElementById(\'submitButton\');<br><br>  artistSearchForm.addEventListener(\'submit\', function (event) {<br>    //Clear up the main content and prevent default<br>    event.preventDefault();<br><br><br>    var articlesDiv = document.getElementById(\'articlesDiv\');<br>    articlesDiv.innerHTML = \'\';<br>    var nameEntryValue = artistNameEntry.value.replace(/\s/g, \'+\');<br><br>    fetch(\'https://api.spotify.com/v1/search?q=\\'\' + nameEntryValue + \'\\'&type=artist&limit=1\',<br>    {<br>      method: \'GET\',<br>      headers: {<br>        \'Authorization\': \'Basic *&lt;base64 encoded d0acac994f0e4947b5eacdc3c480e31d:c5fe231aa97a41b29bef006c193a8a1c&gt;*\',<br>        \'Accept\': \'application/json\',<br>        \'Content-Type\': \'application/json\'<br>      }<br>    })<br>    .then(function (response) {<br>      return response.json();<br>    })<br>    .then(function (json) {<br>      console.log(\'JSON is\', json);<br>      if (json.artists.items[0] === undefined) {<br>        var errorMessage = document.createElement(\'h3\');<br>        errorMessage.innerHTML = \'Sorry but your search did not return any results\';<br>        articlesDiv.appendChild(errorMessage);<br>        artistSearchForm.reset();<br>      }<br>      console.log(\'json.artists is\', json.artists);<br>      var artistId = json.artists.items[0].id;<br>      console.log(\'artistId is\', artistId);<br>      return artistId<br>    })<br>    .then(function (artistId) {<br>      fetch(\'https://api.spotify.com/v1/artists/\' + artistId + \'/albums\',<br>      {<br>        method: \'GET\',<br>        headers: {<br>          \'Authorization\': \'Basic base64 encoded d0acac994f0e4947b5eacdc3c480e31d:c5fe231aa97a41b29bef006c193a8a1c\',<br>          \'Accept\': \'application/json\',<br>          \'Content-Type\': \'application/json\'<br>        }<br>      })<br>      .then(function(response) {<br>        return response.json();<br>      })<br>      .then(function (json) {<br>        var jsonItems = json.items;<br>        console.log(\'json items is\', jsonItems);<br>        var albums = [];<br>        for (let i = 0; i &lt; jsonItems.length; i++) {<br>          var albumItem = {}<br>          albumItem.artistName = artistNameEntry.value<br>          albumItem.albumName = jsonItems[i].name;<br>          albumItem.albumID = jsonItems[i].id;<br>          albumItem.tracks = {};<br>          albumItem.images = jsonItems[i].images;<br>          albums.push(albumItem);<br>        }<br>        return albums;<br>      })<br>      .then(function(albums) {<br>        var trackPromises = [];<br>        for (let j = 0; j &lt; albums.length; j++) {<br>          let trackPromise = fetch(\'https://api.spotify.com/v1/albums/\' + albums[j].albumID + \'/tracks\',<br>          {<br>            method: \'GET\',<br>            headers: {<br>              \'Authorization\': \'Bearer BQBd97aViKgz3QrJQQ8KNh-bc5r8ZEEYYIXrz7fdsaSyQRD_lAHVSGNHfWzuXlrwKyqrPXYWQTM6sQAHw6NHql1q4TFWP9sxqK83bhja_jzpOkLairz61aADXU9Se85RdRd7ZPeWg_142GEB6Q\',<br>              \'Accept\': \'application/json\',<br>              \'Content-Type\': \'application/json\'<br>            }<br>          })<br>          .then(function (response) {<br>            return response.json();<br>          })<br>          .then(function (json) {<br>            var albumTracks = json.items;<br>            for (let k = 0; k &lt; albumTracks.length; k++) {<br>              albums[j].tracks[\'song\'+(k+1)] = albumTracks[k].name;<br>            }<br>            return albums[j];<br>          });<br>          trackPromises.push(trackPromise);<br>        } //End of the for loop<br>        return Promise.all(trackPromises);<br>      })//good up to here. put parenthesis if it does not work<br>      .then(function(albums) {<br>        // var articlesDiv = document.getElementById(\'articlesDiv\');<br><br>        var articleH1 = document.createElement(\'h1\');<br>        // var h1Value = artistNameEntry.value.slice(0,1).toUpperCase() + artistNameEntry.value.slice(1).toLowerCase() + \' Discography\';<br>        var h1Value = artistNameEntry.value[0].toUpperCase();<br>        for (let o = 1; o &lt; artistNameEntry.value.length; o++) {<br>          if (artistNameEntry.value[o-1] === \' \') {<br>            h1Value += artistNameEntry.value[o].toUpperCase();<br>          }<br>          else {<br>            h1Value += artistNameEntry.value[o].toLowerCase();<br>          }<br>        }<br><br>        h1Value += \' Discography\'<br>        articleH1.innerHTML = h1Value;<br>        articlesDiv.appendChild(articleH1)<br><br>        var articleH1 = document.createElement(\'h1\');<br>        articleH1.innerHTML = artistNameEntry;<br><br>        for (let l = 0; l &lt; albums.length; l++) {<br>          var albumTitle = document.createElement(\'h3\');<br>          albumTitle.innerHTML = albums[l].albumName<br>          // console.log(albums[l].images[0].height);<br><br>          let albumSongs = albums[l].tracks;<br><br>          var albumOl = document.createElement(\'ol\');<br>          var counter = 1<br>          for (let key in albumSongs) {<br>            var albumLi = document.createElement(\'li\');<br>            albumLi.innerHTML = counter + \'. \' + albumSongs[key];<br>            albumOl.appendChild(albumLi);<br>            counter++<br>          }<br><br>          var backgroundImageURL = albums[l].images[1].url;<br>          console.log(backgroundImageURL);<br>          // var image = document.createElement(\'img\');<br>          // image.src = backgroundImageURL;<br>          var textDiv = document.createElement(\'div\');<br><br>          var article = document.createElement(\'article\');<br>          article.className += \'albumSlot\';<br>          article.style.background = \'url(\' + backgroundImageURL + \')\';<br>          // article.appendChild(image);<br>          textDiv.appendChild(albumTitle);<br>          textDiv.appendChild(albumOl);<br>          article.appendChild(textDiv);<br><br><br>          // var articlesDiv = document.getElementById(\'articlesDiv\');<br>          articlesDiv.appendChild(article);<br>        }<br>        console.log(albums);<br>      });<br>    });<br>    // artistSearchForm.reset();<br>  }); //End of submit Event Listener<br><br>}; //End of window.onload"}
